allow hal_sensors_default iio_device:chr_file r_file_perms;
allow hal_sensors_default sysfs_iio_devices:dir r_dir_perms;
allow hal_sensors_default sysfs_iio_devices:file rw_file_perms;
allow hal_sensors_default vendor_elliptic_device:chr_file rw_file_perms;
allow hal_sensors_default hal_audio_hwservice:hwservice_manager find;

# Allow ultrasound sensors to w to /dev/socket/audio_hw_socket
allow hal_sensors_default vendor_audio_socket:sock_file w_file_perms;

# Allow sensors hal to call audio
hal_client_domain(hal_sensors_default, hal_audio)
binder_call(hal_sensors_default, hal_audio_default)

# Allow hal_sensors to connect to audio_hw_socket via hal_audio
unix_socket_connect(hal_sensors_default, vendor_audio, hal_audio_default)
